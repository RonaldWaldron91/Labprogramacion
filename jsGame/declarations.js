/**
 * Created by USER on 20/05/2016.
 */

const colorPygmo =
{
    azul:"#179BD3",
    magenta:"#E41C6A",
    amarillo:  "#FDCC5A",
    rojo:"#D62D1B",
    verde:"#61AE24"
};

var Maze = [];

/**Tipo de camino a construir*/
Maze.tile_SHAPES = {
    '10010': [4, 0],  // Dead ends
    '10001': [3, 3],
    '11000': [0, 1],
    '10100': [0, 2],
    '11010': [4, 1],  // Vertical
    '10101': [3, 2],  // Horizontal
    '10110': [0, 0],  // Elbows
    '10011': [2, 0],
    '11001': [4, 2],
    '11100': [2, 3],
    '11110': [1, 1],  // Junctions
    '10111': [1, 0],
    '11011': [2, 1],
    '11101': [1, 2],
    '11111': [2, 2],  // Cross
    'null0': [4, 3],  // Empty
    'null1': [3, 0],
    'null2': [3, 1],
    'null3': [0, 3],
    'null4': [1, 3]
};

Maze.MAX_BLOCKS = [50, // Level 0.
    3, 5, 7, 2, 7, 8, 2, 5, 10, 4, 4, 4, 4, 6, 4, 6, 4, 6, 6, 10][BlocklyGames.LEVEL];

/*El mapa sera representado por una matriz*/
Maze.mapa = [
    // Level 0 o desafio de la semana
    [
        [0, 0, 0, 0, 0, 0, 1 ,1 , 1, 1],
        [0, 0, 0, 1, 0, 0, 0 ,0 , 1, 0],
        [0, 2, 1, 1, 1, 1, 1 ,1 , 1, 0],
        [0, 1, 0, 1, 0, 1, 0 ,0 , 1, 0],
        [0, 1, 1, 1, 0, 1, 1 ,0 , 1, 1],
        [0, 1, 0, 0, 0, 1, 0 ,0 , 0, 1],
        [1, 1, 1, 1, 1, 1, 1 ,1 , 1, 1],
        [0, 1, 0, 1, 0, 1, 0 ,1 , 0, 0],
        [1, 1, 1, 1, 1, 0, 1 ,1 , 3, 0],
        [0, 0, 1, 0, 0, 0, 1 ,0 , 0, 0]
    ],
    //Level 1
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 2, 1, 1, 3, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 2
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 3, 0, 0, 0 ,0],
        [0, 0, 0, 1, 0, 0, 0 ,0],
        [0, 2, 1, 1, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 3
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 2, 1, 1, 0, 0, 0 ,0],
        [0, 0, 0, 1, 0, 0, 0 ,0],
        [0, 0, 0, 1, 3, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 4
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 2, 1, 1, 1, 1, 3 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 5
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,3],
        [0, 0, 0, 0, 0, 0, 0 ,1],
        [0, 0, 0, 0, 0, 1, 1 ,1],
        [0, 0, 0, 0, 0, 1, 0 ,0],
        [0, 0, 0, 1, 1, 1, 0 ,0],
        [0, 0, 0, 1, 0, 0, 0 ,0],
        [0, 2, 1, 1, 0, 0, 0 ,0]
    ],
    //Level 6
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 2, 1, 1, 1, 1, 0 ,0],
        [0, 0, 0, 0, 0, 1, 0 ,0],
        [0, 3, 1, 1, 1, 1, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 7
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 2, 1, 1, 1, 1, 3 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],

    //Level 8
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 2, 1, 1, 1, 0, 0 ,0],
        [0, 0, 0, 0, 1, 0, 0 ,0],
        [0, 0, 0, 0, 1, 0, 0 ,0],
        [0, 3, 1, 1, 1, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 9
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 3, 0 ,0],
        [0, 0, 0, 0, 0, 1, 0 ,0],
        [0, 0, 0, 0, 1, 1, 0 ,0],
        [0, 0, 0, 0, 1, 0, 0 ,0],
        [0, 2, 1, 1, 1, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 10
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 3, 0, 0, 0 ,0],
        [0, 0, 0, 1, 0, 0, 0 ,0],
        [0, 0, 0, 1, 0, 0, 0 ,0],
        [0, 0, 0, 1, 0, 0, 0 ,0],
        [0, 2, 1, 1, 0, 0, 0 ,0],
        [0, 0, 0, 1, 0, 0, 0 ,0]
    ],
    //Level 11
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 1, 0, 0, 0 ,0],
        [0, 0, 2, 1, 1, 1, 0 ,0],
        [0, 0, 0, 0, 0, 1, 0 ,0],
        [0, 0, 0, 0, 0, 1, 0 ,0],
        [0, 0, 0, 3, 1, 1, 1 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 12
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 1, 1, 1, 1, 1, 0 ,0],
        [0, 1, 0, 0, 0, 1, 0 ,0],
        [0, 1, 1, 3, 0, 1, 0 ,0],
        [0, 0, 0, 0, 0, 1, 0 ,0],
        [0, 2, 1, 1, 1, 1, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 13
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 1, 1 ,0],
        [0, 2, 1, 1, 1, 1, 0 ,0],
        [0, 0, 0, 0, 0, 1, 0 ,0],
        [0, 1, 1, 3, 0, 1, 1 ,0],
        [0, 1, 0, 1, 0, 1, 0 ,0],
        [0, 1, 1, 1, 1, 1, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 14
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 1, 1, 1, 1, 1, 0 ,0],
        [0, 1, 0, 0, 0, 1, 1 ,0],
        [0, 1, 1, 1, 0, 0, 1 ,0],
        [0, 0, 0, 1, 0, 0, 1 ,0],
        [0, 2, 1, 1, 0, 0, 3 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 15
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 1, 1, 1, 1, 0 ,0],
        [0, 0, 0, 1, 0, 0, 0 ,0],
        [3, 1, 1, 1, 1, 1, 1 ,0],
        [0, 1, 0, 1, 0, 1, 1 ,0],
        [1, 1, 1, 1, 1, 0, 1 ,0],
        [0, 1, 0, 1, 0, 2, 1 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 16
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 3 ,0],
        [0, 0, 0, 0, 0, 0, 1 ,0],
        [0, 0, 0, 0, 0, 0, 1 ,0],
        [0, 0, 0, 1, 1, 1, 1 ,0],
        [0, 0, 0, 0, 1, 0, 0 ,0],
        [0, 2, 1, 1, 1, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 17
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 1, 0, 0 ,0],
        [0, 2, 1, 1, 1, 1, 0 ,0],
        [0, 0, 1, 0, 0, 1, 0 ,0],
        [0, 0, 0, 0, 0, 1, 0 ,0],
        [0, 0, 1, 0, 1, 1, 0 ,0],
        [0, 3, 1, 1, 1, 1, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 18
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 0, 3, 0, 0, 0, 0 ,0],
        [0, 0, 1, 1, 1, 1, 0 ,0],
        [0, 0, 0, 0, 0, 1, 0 ,0],
        [0, 0, 1, 1, 1, 1, 0 ,0],
        [0, 0, 1, 0, 1, 1, 0 ,0],
        [0, 2, 1, 0, 0, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 19
    [
        [0, 0, 0, 0, 0, 1, 0 ,0],
        [0, 2, 1, 1, 0, 1, 0 ,0],
        [0, 0, 0, 1, 1, 1, 1 ,0],
        [0, 0, 0, 0, 0, 1, 0 ,0],
        [0, 0, 0, 1, 1, 1, 1 ,0],
        [0, 0, 0, 1, 0, 1, 0 ,0],
        [0, 3, 1, 1, 1, 0, 0 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ],
    //Level 20
    [
        [0, 0, 0, 0, 0, 0, 0 ,0],
        [0, 1, 1, 0, 3, 0, 1 ,0],
        [0, 1, 1, 0, 1, 1, 1 ,0],
        [0, 1, 0, 1, 0, 1, 0 ,0],
        [0, 1, 1, 1, 1, 1, 1 ,0],
        [0, 0, 0, 1, 0, 0, 1 ,0],
        [0, 2, 1, 1, 1, 0, 1 ,0],
        [0, 0, 0, 0, 0, 0, 0 ,0]
    ]
][BlocklyGames.LEVEL];

/*Se establecen tama√±os*/
Maze.rows = Maze.mapa.length;
Maze.cols = Maze.mapa[1].length;
Maze.cuadro = 50;
Maze.spriteWidth = 50;
Maze.spriteHeight = 50;

Maze.width = Maze.cols * Maze.cuadro;
Maze.height = Maze.rows * Maze.cuadro;

// Crash type constants.
Maze.CRASH_STOP = 1;
Maze.CRASH_SPIN = 2;
Maze.CRASH_FALL = 3;

/*Tipo de cuadricula*/
Maze.typeSquare = {
    muro: 0,
    camino:1,
    inicio:2,
    finish:3
};

/*Tipo de direccion del sprite*/
Maze.DirectionType = {
    NORTH: 0,
    EAST: 1,
    SOUTH: 2,
    WEST: 3
};

Maze.ResultType = {
    UNSET: 0,
    SUCCESS: 1,
    FAILURE: -1,
    TIMEOUT: 2,
    ERROR: -2
};
/**
 * Result of last execution.
 */
Maze.result = Maze.ResultType.UNSET;

/**
 * Starting direction.
 */
Maze.startDirection = Maze.DirectionType.EAST;

/**
 * PIDs of animation tasks currently executing.
 */
Maze.pidList = [];

Maze.skins = {
    tiles : "img/tiles.png",
    background:"img/bg.png",
    marker:"img/engran.gif",
    sprite:"img/avatar.png",
    look: '#fff',
    crashType: Maze.CRASH_STOP
};

if(BlocklyGames.LEVEL == 0){
    Maze.skins.background = "img/bg500x500.png";
    Maze.skins.tiles = "img/camino_laberinto.png";
}
